{% extends "main/base.html" %}
{% block title %}{% endblock %}
{% block description %}{% endblock %}
{% block content %}
    <div class="container">
        <div class="blog-header">
            <h1 class="blog-title">Event Calendar&nbsp;<a class="btn btn-default" href="/event/create">Add Event</a></h1>
        </div>
        <div class="row">
            <div class="col-sm-6 blog-main">
                {{ calendar|safe }}
            </div>
            <div class="col-sm-6 blog-main" id="event-feed">
                <div class="blog-post">
                    <h2 class="blog-post-title">hoge</h2>
                    <p>description</p>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            $(document).on("click", "td.aday", function () {
                $(".selected").removeClass("selected");
                $(this).addClass("selected");
            });
            $(document).on("click", "th.cmonth", function () {
                location.href = "/?month=" + $(this).attr("id");
            });
            $.ajax({url: "/feed/events",
            }).done(function(data){
              var feed_html = "";
              var feed_template = `
                <div class="blog-post">
                    <h2 class="blog-post-title">$title</h2>
                    <p>$date</p>
                    <p>$description</p>
                </div>
              `;
              $.each(data.events, function(i, val){
                feed_html += feed_template.replace('$title', val.title).replace('$date', val.date).replace('$description', val.description);
              });
              $("#event-feed").html(feed_html);
            }).fail(function(data){
              $("#event-feed").html("failed");
            });
        });
    </script>
{% endblock %}
